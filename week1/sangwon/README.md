# chapter4 처리율 제한 장치의 설계

## 케이스 1: 커뮤니티 서비스

- SNS 커뮤니티 서비스이다
- 사용자는 글 작성 후 5분 내에 다른 글을 작성할 수 없다
- 동일한 IP에서 10분 내에 다른 글을 작성할 수 없다
- 분산 환경에서 처리되어야 한다
- 서비스의 gateway는 상용 서비스를 사용 중이다

## 설계 방향

- 사용자가 글을 작성하러 진입하는 시점에 레디스에 작성한 이력이 있는지 확인
- 이력이 없다면 글 작성 페이지 진입
- 글 작성을 완료하면 레디스에 작성자 회원 번호 저장
  - TTL 은 5분
- 글 작성 후 5분 내에 글 작성 시도를 하면 레디스를 조회해서 만료되지 않은 회원번호가 있는지 확인

### 글 작성 프로세스

![](/week1/sangwon/images/pic1.png)

### 글 작성 불가 프로세스

![](/week1/sangwon/images/pic2.png)
